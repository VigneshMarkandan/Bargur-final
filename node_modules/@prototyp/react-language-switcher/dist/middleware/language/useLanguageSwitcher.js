"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var react_1 = require("react");
var context_1 = require("../../context");
function useLanguageSwitcher(props) {
    var updateValue = context_1.useSwitcherContext().updateValue;
    /**
     * @description Set default language for this middleware to english
     */
    var _a = props.defaultLanguage, defaultLanguage = _a === void 0 ? 'en' : _a, _b = props.languageList, languageList = _b === void 0 ? ['en'] : _b, valueSelector = props.valueSelector;
    /**
     * @description Function that resets language if it is not correct
     */
    var normalizeLanguage = function (lang) {
        return lang.length === 2 ? lang : defaultLanguage;
    };
    /**
     * @description Internal state and handler for setting language
     */
    var _c = react_1.useState(normalizeLanguage(defaultLanguage)), currentLanguage = _c[0], setCurrentLanguage = _c[1];
    react_1.useEffect(function () {
        updateValue(valueSelector, currentLanguage);
    }, [currentLanguage]);
    var updateLanguage = function (lang) {
        return setCurrentLanguage(normalizeLanguage(lang));
    };
    /**
     * @description Register middleware
     */
    var registerMiddleware = context_1.useSwitcherContext().registerMiddleware;
    react_1.useEffect(function () {
        if (registerMiddleware) {
            registerMiddleware('LanguageSwitcher', {
                language: currentLanguage,
                languageList: languageList,
                updateLanguage: updateLanguage,
            });
        }
    }, []);
}
exports.useLanguageSwitcher = useLanguageSwitcher;
